(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function u(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=u(e);fetch(e.href,t)}})();document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("fodaForm"),n=Array.from(document.querySelectorAll(".step:not(#successStep)")),u=document.getElementById("successStep"),a=document.getElementById("progressBar"),e=document.getElementById("nextBtn"),t=document.getElementById("prevBtn"),r=document.getElementById("submitBtn"),g=document.getElementById("navButtons"),p=document.querySelector("header p");let o=0;function f(){n.forEach((i,d)=>{i.classList.toggle("active",d===o)});const c=(o+1)/n.length*100;a.style.width=`${c}%`,t.classList.toggle("hidden",o===0),o===n.length-1?(e.classList.add("hidden"),r.classList.remove("hidden")):(e.classList.remove("hidden"),r.classList.add("hidden")),window.scrollTo({top:0,behavior:"smooth"})}function h(){const c=n[o],i=c.querySelectorAll("input[required]");let d=!0;const m=new Set;return i.forEach(s=>m.add(s.name)),m.forEach(s=>{if(!c.querySelector(`input[name="${s}"]:checked`)){d=!1;const y=c.querySelector(`input[name="${s}"]`).closest(".question");y.style.borderLeft="4px solid #ef4444",setTimeout(()=>y.style.borderLeft="none",2e3)}}),d}e.addEventListener("click",()=>{h()?o<n.length-1&&(o++,f()):alert("Por favor, califica los puntos clave antes de continuar.")}),t.addEventListener("click",()=>{o>0&&(o--,f())}),l.addEventListener("submit",c=>{if(c.preventDefault(),!h())return;const i=new FormData(l);Object.fromEntries(i.entries()),r.disabled=!0;const d=r.innerHTML;r.innerHTML="Enviando a Matriz...",p.innerText="Generando Matriz de Calidad Institucional...",fetch("https://script.google.com/macros/s/AKfycbyi7t55HXAxBNdVortheg-9McJEU8kBXeSqrrlyRlqs3XfcrQ_GYbttNUEva4bCNoQxyw/exec",{method:"POST",mode:"no-cors",body:new URLSearchParams(i)}).then(()=>{n.forEach(s=>s.classList.remove("active")),u.classList.add("active"),g.classList.add("hidden"),a.parentElement.style.display="none",p.innerText="¡Análisis 2024 Generado con Éxito!"}).catch(s=>{console.error("Error al enviar:",s),alert("Hubo un error al guardar los datos. Por favor, intenta de nuevo."),r.disabled=!1,r.innerHTML=d})}),f()});
